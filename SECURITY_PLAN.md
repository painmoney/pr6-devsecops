# План безопасности Flask Notes Application
# ПР №6: DevSecOps и план безопасности

## 1. Общие сведения
**Приложение:** Система безопасных заметок  
**Цель:** Обеспечение комплексной безопасности веб-приложения  
**Дата создания:** $(дата)  
**Версия плана:** 1.0

## 2. Цели безопасности
- [x] Защита данных пользователей (пароли, заметки)
- [x] Предотвращение несанкционированного доступа
- [x] Соответствие требованиям OWASP Top 10
- [x] Интеграция безопасности в процесс разработки (DevSecOps)

## 3. Оценка угроз (на основе ПР №4)

### 3.1 Протестированные угрозы:
| Угроза | Статус | Метод тестирования |
|--------|--------|-------------------|
| SQL-инъекции | ✅ Защищено | SQLMap, ручное тестирование |
| CSRF-атаки | ✅ Защищено | Flask-WTF токены |
| XSS-атаки | ⚠️ Частично | Базовые меры в шаблонах |
| Небезопасная аутентификация | ✅ Защищено | Хэширование паролей |

### 3.2 Выявленные уязвимости в ПР №4:
1. **SQL-инъекции в GET-параметрах** - исправлено параметризованными запросами
2. **Отсутствие хэширования паролей** - исправлено использованием `security_utils.py`
3. **CSRF-уязвимости** - исправлено внедрением Flask-WTF

## 4. Реализованные меры защиты

### 4.1 Уровень приложения:
- [x] **Аутентификация:** Хэширование паролей (bcrypt/scrypt)
- [x] **Валидация:** WTForms для всех форм
- [x] **Безопасность БД:** SQLAlchemy ORM, параметризованные запросы
- [x] **Сессии:** Безопасные куки, server-side сессии
- [x] **Защита от CSRF:** Flask-WTF токены
- [x] **Security Headers:** CSP, HSTS, X-Frame-Options

### 4.2 Уровень инфраструктуры:
- [x] **Конфигурация:** Разделение dev/prod настроек
- [x] **Зависимости:** Регулярное обновление requirements.txt
- [x] **Среда выполнения:** Виртуальное окружение Python

### 4.3 Уровень процесса:
- [x] **Код-ревью:** Проверка security-аспектов
- [x] **Тестирование:** Автоматизированные security-тесты
- [x] **Документация:** План безопасности, README

## 5. План регулярного тестирования

### 5.1 Ежедневно/при каждом коммите:
- Статический анализ (SAST) - Bandit
- Тестирование зависимостей - Safety

### 5.2 Еженедельно:
- Запуск security-тестов (`pytest tests/test_security.py`)
- Обновление зависимостей
- Проверка логов безопасности

### 5.3 Ежемесячно:
- Сканирование DAST (OWASP ZAP)
- Аудит конфигураций
- Ручное тестирование критических функций

### 5.4 Квартально:
- Полное тестирование на проникновение
- Обновление плана безопасности
- Обучение команды

## 6. DevSecOps Pipeline

### 6.1 Инструменты:
- **GitHub Actions** - CI/CD автоматизация
- **Bandit** - статический анализ Python кода
- **Safety** - проверка уязвимостей зависимостей
- **Pytest** - автоматизированные тесты

### 6.2 Workflow этапы:
1. **SAST анализ** - Bandit проверяет код на уязвимости
2. **Dependency check** - Safety сканирует зависимости
3. **Security тесты** - Pytest запускает security-тесты
4. **Debug check** - Проверка debug режима
5. **Деплой** - Только при успешных проверках

### 6.3 Критерии блокировки:
- ⛔ Критические уязвимости в Bandit
- ⛔ Уязвимости в зависимостях (CVSS > 7.0)
- ⛔ Проваленные security-тесты
- ⛔ Debug режим в production коде

## 7. Процедура реагирования на инциденты

### 7.1 Обнаружение:
- Мониторинг логов приложения
- Оповещения от CI/CD pipeline
- Reports от пользователей

### 7.2 Эскалация:
1. Низкий риск: Исправление в течение 7 дней
2. Средний риск: Исправление в течение 48 часов
3. Высокий риск: Немедленное исправление, возможен откат

### 7.3 Восстановление:
- Резервное копирование данных ежедневно
- Документирование инцидента
- Анализ root-cause

## 8. Ответственные лица
- **Разработчик:** Реализация security-фич
- **Тестировщик:** Проведение security-тестов
- **DevOps:** Настройка и мониторинг pipeline

## Приложения
1. `.bandit.yml` - конфигурация статического анализатора
2. `.github/workflows/security.yml` - CI/CD pipeline
3. `tests/test_security.py` - security-тесты

---
*Документ обновляется при изменении архитектуры или выявлении новых угроз*